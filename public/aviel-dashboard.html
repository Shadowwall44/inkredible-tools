<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<title>Aviel Dashboard</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root,[data-theme="light"]{
--bg-primary:#f4f7f6;--bg-mesh-1:rgba(16,185,129,.10);--bg-mesh-2:rgba(134,239,172,.08);--bg-mesh-3:rgba(245,158,11,.06);
--bg-panel:rgba(255,255,255,.68);--bg-panel-hover:rgba(255,255,255,.88);--bg-card:rgba(255,255,255,.55);--bg-card-hover:rgba(255,255,255,.82);
--border-subtle:rgba(0,0,0,.06);--border-hover:rgba(16,185,129,.25);
--text-primary:#1a1a2e;--text-secondary:#475569;--text-muted:#94a3b8;
--accent-mint:#10b981;--accent-sage:#6ee7b7;--accent-amber:#f59e0b;--accent-red:#ef4444;--accent-blue:#3b82f6;--accent-purple:#8b5cf6;
--pill-ok-bg:#d1fae5;--pill-ok-text:#059669;--pill-warn-bg:#fef3c7;--pill-warn-text:#d97706;--pill-err-bg:#fee2e2;--pill-err-text:#dc2626;
--toggle-bg:#e2e8f0;--toggle-knob:#fff;
--shadow-panel:0 1px 2px rgba(0,0,0,.03),0 4px 8px rgba(0,0,0,.04),0 8px 16px rgba(0,0,0,.04),0 16px 32px rgba(0,0,0,.03);
--shadow-panel-h:0 2px 4px rgba(0,0,0,.04),0 8px 16px rgba(0,0,0,.06),0 16px 32px rgba(0,0,0,.06);
--shadow-card:0 1px 3px rgba(0,0,0,.03),0 4px 12px rgba(0,0,0,.04);
--shadow-card-h:0 4px 8px rgba(0,0,0,.06),0 12px 28px rgba(0,0,0,.08);
--radius-sm:10px;--radius-md:14px;--radius-lg:20px;--radius-full:9999px;
}
[data-theme="dark"]{
--bg-primary:#0f172a;--bg-mesh-1:rgba(16,185,129,.07);--bg-mesh-2:rgba(139,92,246,.06);--bg-mesh-3:rgba(59,130,246,.05);
--bg-panel:rgba(255,255,255,.05);--bg-panel-hover:rgba(255,255,255,.08);--bg-card:rgba(255,255,255,.04);--bg-card-hover:rgba(255,255,255,.08);
--border-subtle:rgba(255,255,255,.08);--border-hover:rgba(16,185,129,.3);
--text-primary:#f1f5f9;--text-secondary:rgba(255,255,255,.6);--text-muted:rgba(255,255,255,.35);
--pill-ok-bg:rgba(16,185,129,.15);--pill-ok-text:#34d399;--pill-warn-bg:rgba(245,158,11,.15);--pill-warn-text:#fbbf24;--pill-err-bg:rgba(239,68,68,.15);--pill-err-text:#f87171;
--toggle-bg:rgba(255,255,255,.1);--toggle-knob:#1e293b;
--shadow-panel:0 2px 8px rgba(0,0,0,.2),0 8px 24px rgba(0,0,0,.15);
--shadow-panel-h:0 4px 12px rgba(0,0,0,.3),0 16px 40px rgba(0,0,0,.2);
--shadow-card:0 2px 8px rgba(0,0,0,.15);--shadow-card-h:0 4px 16px rgba(0,0,0,.25);
}
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
body{
font-family:'Plus Jakarta Sans',-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;
background:var(--bg-primary);color:var(--text-primary);
-webkit-font-smoothing:antialiased;font-size:15px;line-height:1.6;
min-height:100vh;min-height:100dvh;overflow-x:hidden;
background-image:
 radial-gradient(ellipse 80% 60% at 0% 0%,var(--bg-mesh-1) 0%,transparent 60%),
 radial-gradient(ellipse 60% 70% at 100% 100%,var(--bg-mesh-3) 0%,transparent 60%),
 radial-gradient(ellipse 50% 50% at 50% 40%,var(--bg-mesh-2) 0%,transparent 50%);
}
a{color:inherit;text-decoration:none}button{font-family:inherit}
.dash{max-width:720px;margin:0 auto;padding:16px 16px 48px;display:flex;flex-direction:column;gap:20px}
/* HEADER */
.hdr{display:flex;align-items:center;justify-content:space-between;padding:6px 0}
.back-pill{display:inline-flex;align-items:center;gap:6px;font-size:13px;font-weight:600;color:var(--text-secondary);
padding:8px 14px;border-radius:var(--radius-full);background:var(--bg-panel);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);
border:1px solid var(--border-subtle);transition:all .25s}
.back-pill:hover{background:var(--bg-panel-hover);border-color:var(--border-hover);color:var(--text-primary)}
.back-pill svg{width:16px;height:16px}
.theme-toggle{width:52px;height:28px;border-radius:14px;background:var(--toggle-bg);border:1px solid var(--border-subtle);
cursor:pointer;position:relative;transition:all .3s;-webkit-tap-highlight-color:transparent;padding:0}
.theme-toggle:hover{border-color:var(--border-hover)}
.tknob{position:absolute;top:2px;left:2px;width:22px;height:22px;border-radius:50%;background:var(--toggle-knob);
display:flex;align-items:center;justify-content:center;transition:transform .3s cubic-bezier(.4,0,.2,1);box-shadow:0 1px 3px rgba(0,0,0,.15)}
.tknob svg{width:14px;height:14px;color:var(--accent-amber)}
[data-theme="dark"] .tknob{transform:translateX(24px)}
[data-theme="dark"] .tknob svg{color:var(--accent-blue)}
.ptitle{text-align:center;padding:4px 0 0}
.ptitle h1{font-family:'Plus Jakarta Sans',sans-serif;font-size:1.75rem;font-weight:800;letter-spacing:-.03em;line-height:1.2}
.ptitle .greet{font-size:14px;font-weight:500;color:var(--text-muted);margin-top:4px}
/* PANEL */
.panel{background:var(--bg-panel);backdrop-filter:blur(24px);-webkit-backdrop-filter:blur(24px);
border:1px solid var(--border-subtle);border-radius:var(--radius-lg);padding:24px;box-shadow:var(--shadow-panel);transition:all .3s}
.shdr{display:flex;align-items:center;gap:8px;margin-bottom:16px}
.shdr .si{width:18px;height:18px;color:var(--accent-mint);flex-shrink:0}
.shdr h2{font-family:'Plus Jakarta Sans',sans-serif;font-size:.8125rem;font-weight:700;text-transform:uppercase;letter-spacing:.06em;color:var(--text-muted)}
.shdr .cpill{margin-left:auto;font-size:11px;font-weight:700;padding:2px 10px;border-radius:var(--radius-full);background:var(--pill-ok-bg);color:var(--pill-ok-text)}
/* FOCUS */
.focus{position:relative;overflow:hidden;text-align:center;padding:36px 28px 32px;border-color:rgba(16,185,129,.12)}
.focus::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;
background:linear-gradient(90deg,var(--accent-mint),var(--accent-sage),var(--accent-amber));border-radius:var(--radius-lg) var(--radius-lg) 0 0}
.focus .shdr{justify-content:center;margin-bottom:14px}
.ftxt{font-family:'Plus Jakarta Sans',sans-serif;font-size:1.3rem;font-weight:700;letter-spacing:-.01em;line-height:1.35}
.fmeta{font-size:13px;color:var(--text-muted);margin-top:10px;font-weight:500}
/* ACTIVITY FEED */
.fscroll{max-height:420px;overflow-y:auto;margin:0 -4px;padding:0 4px;scrollbar-width:thin;scrollbar-color:var(--border-subtle) transparent}
.fscroll::-webkit-scrollbar{width:4px}
.fscroll::-webkit-scrollbar-thumb{background:var(--border-subtle);border-radius:4px}
.fi{display:flex;align-items:flex-start;gap:12px;padding:12px 0;border-bottom:1px solid var(--border-subtle)}
.fi:last-child{border-bottom:none}
.ftico{width:32px;height:32px;border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0;
background:var(--bg-card);border:1px solid var(--border-subtle)}
.ftico svg{width:16px;height:16px}
.ftico.t-cron{color:var(--accent-blue)}.ftico.t-agent{color:var(--accent-purple)}.ftico.t-deploy{color:var(--accent-mint)}.ftico.t-gen{color:var(--text-muted)}
.fcont{flex:1;min-width:0}
.fname{font-size:14px;font-weight:600;line-height:1.3;word-break:break-word}
.fdet{font-size:12px;color:var(--text-muted);margin-top:2px;line-height:1.3}
.fright{display:flex;flex-direction:column;align-items:flex-end;gap:4px;flex-shrink:0}
.ftime{font-size:11px;font-weight:600;color:var(--text-muted);white-space:nowrap}
.sdot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.sdot.ok{background:var(--accent-mint);box-shadow:0 0 6px rgba(16,185,129,.5)}
.sdot.err{background:var(--accent-red);box-shadow:0 0 6px rgba(239,68,68,.5)}
.sdot.wrk{background:var(--accent-blue);box-shadow:0 0 6px rgba(59,130,246,.5);animation:dpulse 2s ease-in-out infinite}
@keyframes dpulse{0%,100%{opacity:1}50%{opacity:.4}}
.fempty{text-align:center;color:var(--text-muted);font-size:14px;padding:32px 16px;font-weight:500}
/* CRON */
.ctoggle{display:flex;align-items:center;width:100%;cursor:pointer;background:none;border:none;padding:0;color:inherit;-webkit-tap-highlight-color:transparent}
.ctoggle .chev{width:16px;height:16px;color:var(--text-muted);transition:transform .3s;margin-left:8px}
.cpanel.exp .ctoggle .chev{transform:rotate(180deg)}
.clist{max-height:0;overflow:hidden;transition:max-height .35s cubic-bezier(.4,0,.2,1)}
.cpanel.exp .clist{max-height:600px}
.clinner{padding-top:16px;display:flex;flex-direction:column;gap:8px}
.ci{display:flex;align-items:center;gap:10px;padding:10px 12px;background:var(--bg-card);border:1px solid var(--border-subtle);border-radius:var(--radius-md);transition:all .2s}
.ci:hover{border-color:var(--border-hover)}
.cname{font-size:13px;font-weight:600;flex:1;min-width:0}
.cpil{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.04em;padding:3px 10px;border-radius:var(--radius-full);white-space:nowrap}
.cpil.ok{background:var(--pill-ok-bg);color:var(--pill-ok-text)}
.cpil.warn{background:var(--pill-warn-bg);color:var(--pill-warn-text)}
.cpil.err{background:var(--pill-err-bg);color:var(--pill-err-text)}
.ctimes{font-size:11px;color:var(--text-muted);text-align:right;flex-shrink:0;line-height:1.4}
/* QUICK LAUNCH */
.lgrid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.lcard{display:flex;flex-direction:column;align-items:center;text-align:center;padding:20px 10px 16px;
background:var(--bg-card);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);
border:1px solid var(--border-subtle);border-radius:var(--radius-md);box-shadow:var(--shadow-card);
transition:all .25s cubic-bezier(.4,0,.2,1);cursor:pointer;position:relative}
.lcard:hover{transform:translateY(-3px) scale(1.02);box-shadow:var(--shadow-card-h);border-color:var(--border-hover);background:var(--bg-card-hover)}
.lcard:active{transform:translateY(-1px) scale(1.01)}
.lcard .lico{width:32px;height:32px;margin-bottom:10px;color:var(--accent-mint)}
.lcard .lname{font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:700;margin-bottom:3px;line-height:1.3}
.lcard .ldesc{font-size:11px;color:var(--text-muted);line-height:1.35}
.lcard .ext{position:absolute;top:8px;right:8px;width:12px;height:12px;color:var(--text-muted);opacity:.5}
/* STATUS BAR */
.sbar{display:flex;align-items:center;justify-content:space-around;gap:8px;padding:14px 16px;flex-wrap:wrap}
.sbi{display:flex;align-items:center;gap:8px;font-size:12px;font-weight:600;color:var(--text-secondary);white-space:nowrap}
.sbi .sdot{width:7px;height:7px}
.sbi svg{width:14px;height:14px;color:var(--text-muted)}
/* FOOTER */
.foot{text-align:center;font-size:12px;color:var(--text-muted);padding:8px 0;display:flex;align-items:center;justify-content:center;gap:6px;font-weight:500}
.foot svg{width:14px;height:14px;color:var(--accent-amber)}
/* ANIM */
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.ain{animation:fadeUp .45s ease both}
.ain:nth-child(2){animation-delay:.06s}.ain:nth-child(3){animation-delay:.12s}.ain:nth-child(4){animation-delay:.18s}
.ain:nth-child(5){animation-delay:.24s}.ain:nth-child(6){animation-delay:.30s}.ain:nth-child(7){animation-delay:.36s}.ain:nth-child(8){animation-delay:.42s}
/* RESPONSIVE */
@media(max-width:400px){
.dash{padding:12px 12px 36px;gap:16px}.panel{padding:18px 14px}.focus{padding:28px 18px 24px}
.ftxt{font-size:1.1rem}.ptitle h1{font-size:1.5rem}
.lgrid{gap:8px}.lcard{padding:14px 8px 12px}.lcard .lico{width:26px;height:26px;margin-bottom:8px}
.lcard .lname{font-size:11px}.lcard .ldesc{display:none}
.sbar{flex-direction:column;gap:6px}.fscroll{max-height:340px}.ctimes{display:none}
}
@media(min-width:601px){.dash{padding:24px 24px 56px;gap:24px}.ptitle h1{font-size:2rem}.ftxt{font-size:1.4rem}.panel{padding:28px}}
</style>
<script>(function(){var s=localStorage.getItem('aviel-dash-theme')||'light';document.documentElement.setAttribute('data-theme',s)})()</script>
</head>
<body>
<div class="dash">

<!-- HEADER -->
<div class="hdr ain">
 <a href="index.html" class="back-pill"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>Hub</a>
 <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme"><div class="tknob" id="tknob"></div></button>
</div>

<!-- TITLE -->
<header class="ptitle ain">
 <h1>Aviel Dashboard</h1>
 <p class="greet" id="greeting"></p>
</header>

<!-- TODAY'S FOCUS -->
<section class="panel focus ain">
 <div class="shdr">
  <svg class="si" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>
  <h2>Today's Focus</h2>
 </div>
 <div class="ftxt" id="focusText">Check Telegram for today's push</div>
 <div class="fmeta" id="focusMeta"></div>
</section>

<!-- LIVE ACTIVITY -->
<section class="panel ain">
 <div class="shdr">
  <svg class="si" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
  <h2>Live Activity</h2>
  <span class="cpill" id="actCnt">0</span>
 </div>
 <div class="fscroll" id="feedBox"><div class="fempty">Activity feed is syncing... check back in 15 minutes</div></div>
</section>

<!-- CRON STATUS -->
<section class="panel cpanel ain" id="cronPanel">
 <button class="ctoggle" onclick="toggleCrons()" aria-expanded="false">
  <div class="shdr" style="margin-bottom:0">
   <svg class="si" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
   <h2>Cron Jobs</h2>
   <span class="cpill" id="cronCnt">0</span>
  </div>
  <svg class="chev" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
 </button>
 <div class="clist" id="cronList"><div class="clinner" id="cronItems"></div></div>
</section>

<!-- QUICK LAUNCH -->
<section class="panel ain">
 <div class="shdr">
  <svg class="si" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
  <h2>Quick Launch</h2>
 </div>
 <div class="lgrid">
  <a href="index.html" class="lcard">
   <svg class="lico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
   <span class="lname">Hub</span><span class="ldesc">Home base</span>
  </a>
  <a href="command-center.html" class="lcard">
   <svg class="lico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
   <span class="lname">Command Center</span><span class="ldesc">Focus & capture</span>
  </a>
  <a href="dashboard.html" class="lcard">
   <svg class="lico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/></svg>
   <span class="lname">Financial</span><span class="ldesc">P&amp;L & expenses</span>
  </a>
  <a href="mission-control.html" class="lcard">
   <svg class="lico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/></svg>
   <span class="lname">Mission Control</span><span class="ldesc">AI team status</span>
  </a>
  <a href="mis.html" class="lcard">
   <svg class="lico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>
   <span class="lname">MIS</span><span class="ldesc">Jobs & customers</span>
  </a>
  <a href="second-brain.html" class="lcard">
   <svg class="lico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 2A2.5 2.5 0 0112 4.5v15a2.5 2.5 0 01-4.96.44 2.5 2.5 0 01-2.96-3.08 3 3 0 01-.34-5.58 2.5 2.5 0 011.32-4.24 2.5 2.5 0 011.98-3A2.5 2.5 0 019.5 2z"/><path d="M14.5 2A2.5 2.5 0 0012 4.5v15a2.5 2.5 0 004.96.44 2.5 2.5 0 002.96-3.08 3 3 0 00.34-5.58 2.5 2.5 0 00-1.32-4.24 2.5 2.5 0 00-1.98-3A2.5 2.5 0 0014.5 2z"/></svg>
   <span class="lname">Second Brain</span><span class="ldesc">Search everything</span>
  </a>
  <a href="vectorflow.html" class="lcard">
   <svg class="lico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 4V2m0 14v-2M8 9h2m10 0h2M17.8 11.8L19 13m0-8l-1.2 1.2M3 21l9-9m.2-5.8L11 5"/></svg>
   <span class="lname">VectorFlow</span><span class="ldesc">Image to vector</span>
  </a>
  <a href="https://shadowwall44.github.io/kanban/work.html" class="lcard" target="_blank" rel="noopener">
   <svg class="lico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="9" y1="3" x2="9" y2="21"/><line x1="15" y1="3" x2="15" y2="21"/></svg>
   <span class="lname">Work Board</span><span class="ldesc">Business tasks</span>
   <svg class="ext" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
  </a>
  <a href="https://shadowwall44.github.io/kanban/personal.html" class="lcard" target="_blank" rel="noopener">
   <svg class="lico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg>
   <span class="lname">Personal Board</span><span class="ldesc">Personal tasks</span>
   <svg class="ext" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
  </a>
 </div>
</section>

<!-- SYSTEM STATUS -->
<section class="panel ain">
 <div class="shdr">
  <svg class="si" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12.55a11 11 0 0114.08 0"/><path d="M1.42 9a16 16 0 0121.16 0"/><path d="M8.53 16.11a6 6 0 016.95 0"/><circle cx="12" cy="20" r="1"/></svg>
  <h2>System Status</h2>
 </div>
 <div class="sbar">
  <div class="sbi"><span class="sdot ok" id="chetDot"></span><span id="chetStatus">ChetGPT Online</span></div>
  <div class="sbi"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg><span id="cronStatus">0 Active Crons</span></div>
  <div class="sbi"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg><span id="lastAct">--</span></div>
 </div>
</section>

<!-- FOOTER -->
<footer class="foot ain">
 Built by ChetGPT
 <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
 for INKredible Printing
</footer>

</div>

<script>
console.log('Aviel Dashboard v3 \u2014 Built by ChetGPT');

/* ===== SVG ICON TEMPLATES ===== */
var IC={
gear:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 01-2.83 2.83l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9c.26.6.85 1 1.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/></svg>',
robot:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="10" rx="2"/><circle cx="12" cy="5" r="2"/><path d="M12 7v4"/><circle cx="8" cy="16" r="1"/><circle cx="16" cy="16" r="1"/></svg>',
rocket:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 00-2.91-.09z"/><path d="M12 15l-3-3a22 22 0 012-3.95A12.88 12.88 0 0122 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 01-4 2z"/><path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/><path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/></svg>',
check:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>',
pulse:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>'
};

/* ===== THEME TOGGLE ===== */
function toggleTheme(){
 var h=document.documentElement,d=h.getAttribute('data-theme')==='dark',n=d?'light':'dark';
 h.setAttribute('data-theme',n);localStorage.setItem('aviel-dash-theme',n);updateKnob();
}
function updateKnob(){
 var d=document.documentElement.getAttribute('data-theme')==='dark';
 document.getElementById('tknob').innerHTML=d
  ?'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>'
  :'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>';
}

/* ===== GREETING ===== */
function setGreeting(){
 var h=new Date().getHours(),p=h<12?'morning':h<17?'afternoon':'evening';
 var d=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'][new Date().getDay()];
 document.getElementById('greeting').textContent='Good '+p+', Aviel \u2014 '+d;
}

/* ===== EMOJI STRIP ===== */
function stripEmoji(s){
 return s.replace(/[\u{1F300}-\u{1FFFF}\u{2600}-\u{27BF}\u{FE00}-\u{FE0F}\u{200D}\u{20E3}\u{E0020}-\u{E007F}\u2705\u2714\u26A1\u2B50]/gu,'').replace(/^\s+/,'');
}

/* ===== CLASSIFY ACTIVITY TYPE ===== */
function classifyAct(text){
 var t=text.toLowerCase();
 if(/cron|schedule|gauge|morning brief|journaling|nightly|post-shabbat/.test(t))return'cron';
 if(/agent|codex|engineer|researcher|sub-agent|brain/.test(t))return'agent';
 if(/deploy|push|ship|release|gh-pages|vercel/.test(t))return'deploy';
 return'gen';
}
function typeIcon(type){
 if(type==='cron')return'<div class="ftico t-cron">'+IC.gear+'</div>';
 if(type==='agent')return'<div class="ftico t-agent">'+IC.robot+'</div>';
 if(type==='deploy')return'<div class="ftico t-deploy">'+IC.rocket+'</div>';
 return'<div class="ftico t-gen">'+IC.pulse+'</div>';
}

/* ===== STATUS DOT FROM TEXT ===== */
function statusFromText(text){
 var t=text.toLowerCase();
 if(/error|fail|broken|crash/.test(t))return'err';
 return'ok';
}

/* ===== TIME FORMAT ===== */
function fmtTime(timeStr,refDate){
 if(!timeStr)return'';
 /* If it looks like HH:MM, format as 12h */
 var m=timeStr.match(/^(\d{1,2}):(\d{2})$/);
 if(m){
  var hh=parseInt(m[1]),mm=m[2],ap=hh>=12?'PM':'AM';
  hh=hh%12||12;
  return hh+':'+mm+' '+ap;
 }
 /* If ISO date, show relative */
 try{
  var d=new Date(timeStr),now=new Date(),diff=now-d,mins=Math.floor(diff/60000);
  if(mins<1)return'Just now';
  if(mins<60)return mins+'m ago';
  var hrs=Math.floor(mins/60);
  if(hrs<24)return hrs+'h ago';
  var days=Math.floor(hrs/24);
  if(days<7)return days+'d ago';
  return d.toLocaleDateString('en-US',{month:'short',day:'numeric'});
 }catch(e){return timeStr;}
}

/* ===== CRON TOGGLE ===== */
function toggleCrons(){
 var p=document.getElementById('cronPanel');
 p.classList.toggle('exp');
 var b=p.querySelector('.ctoggle');
 b.setAttribute('aria-expanded',p.classList.contains('exp'));
}

/* ===== LOAD DATA ===== */
function loadData(){
 var urls=['data/status.json','status.json'];
 var done=false;
 function tryUrl(i){
  if(i>=urls.length||done)return;
  fetch(urls[i]+'?v='+Date.now()).then(function(r){
   if(!r.ok)throw new Error('not found');return r.json();
  }).then(function(data){
   if(done)return;done=true;renderData(data);
  }).catch(function(){tryUrl(i+1);});
 }
 tryUrl(0);
}

function renderData(data){
 /* TODAY'S FOCUS */
 var focusEl=document.getElementById('focusText');
 var metaEl=document.getElementById('focusMeta');
 if(data.todaysFocus){
  focusEl.textContent=data.todaysFocus;
 }else if(data.tasks&&data.tasks.inProgress&&data.tasks.inProgress.length>0){
  focusEl.textContent=data.tasks.inProgress[0].title;
  var mm=[];
  if(data.tasks.inProgress[0].agent)mm.push('Agent: '+data.tasks.inProgress[0].agent);
  if(data.tasks.inProgress[0].priority)mm.push('Priority: '+data.tasks.inProgress[0].priority);
  metaEl.textContent=mm.join(' \u2022 ');
 }

 /* ACTIVITY FEED */
 var act=data.activity||[];
 document.getElementById('actCnt').textContent=act.length;
 var box=document.getElementById('feedBox');
 if(act.length===0){
  box.innerHTML='<div class="fempty">Activity feed is syncing... check back in 15 minutes</div>';
 }else{
  var html='';
  var items=act.slice(0,20);
  for(var i=0;i<items.length;i++){
   var a=items[i];
   var rawText=a.text||a.name||'';
   var cleanText=stripEmoji(rawText);
   var type=classifyAct(rawText);
   var stat=statusFromText(rawText);
   var time=fmtTime(a.time||a.timestamp,data.lastUpdated);
   html+='<div class="fi">';
   html+=typeIcon(type);
   html+='<div class="fcont"><div class="fname">'+escHtml(cleanText)+'</div></div>';
   html+='<div class="fright"><span class="ftime">'+escHtml(time)+'</span><span class="sdot '+stat+'"></span></div>';
   html+='</div>';
  }
  box.innerHTML=html;
 }

 /* CRONS */
 var crons=data.crons||data.schedule||[];
 document.getElementById('cronCnt').textContent=crons.length+' total';
 /* Sort: errors first, then by name */
 crons.sort(function(a,b){
  var sa=a.status==='error'?0:a.status==='warning'?1:2;
  var sb=b.status==='error'?0:b.status==='warning'?1:2;
  if(sa!==sb)return sa-sb;
  return(a.name||'').localeCompare(b.name||'');
 });
 var cronBox=document.getElementById('cronItems');
 var ch='';
 var okCt=0,warnCt=0,errCt=0;
 for(var j=0;j<crons.length;j++){
  var c=crons[j];
  var ps=c.status==='error'?'err':c.status==='warning'?'warn':'ok';
  var pl=c.status==='error'?'Error':c.status==='warning'?'Warning':'OK';
  if(ps==='ok')okCt++;else if(ps==='warn')warnCt++;else errCt++;
  ch+='<div class="ci">';
  ch+='<span class="cname">'+escHtml(c.name||'')+'</span>';
  ch+='<span class="cpil '+ps+'">'+pl+'</span>';
  ch+='<span class="ctimes">'+escHtml(c.lastRun||c.schedule||'')+'</span>';
  ch+='</div>';
 }
 cronBox.innerHTML=ch;
 /* Update count pill with summary */
 var summary=[];
 if(okCt>0)summary.push(okCt+' OK');
 if(warnCt>0)summary.push(warnCt+' Warn');
 if(errCt>0)summary.push(errCt+' Err');
 document.getElementById('cronCnt').textContent=summary.join(', ')||'0';
 /* Color the pill based on worst status */
 var cpel=document.getElementById('cronCnt');
 if(errCt>0){cpel.style.background='var(--pill-err-bg)';cpel.style.color='var(--pill-err-text)';}
 else if(warnCt>0){cpel.style.background='var(--pill-warn-bg)';cpel.style.color='var(--pill-warn-text)';}

 /* SYSTEM STATUS */
 var agents=data.agents||[];
 var brain=null;
 for(var k=0;k<agents.length;k++){if(agents[k].id==='brain'){brain=agents[k];break;}}
 if(data.agent){brain=data.agent;}
 var dot=document.getElementById('chetDot');
 var stEl=document.getElementById('chetStatus');
 if(brain){
  var bs=brain.status||'active';
  if(bs==='working'||bs==='online'){dot.className='sdot ok';stEl.textContent='ChetGPT Online';}
  else if(bs==='active'){dot.className='sdot wrk';stEl.textContent='ChetGPT Active';}
  else{dot.className='sdot';dot.style.background='#6b7280';stEl.textContent='ChetGPT Standby';}
 }

 /* Active crons count */
 var activeCrons=(data.crons||data.schedule||[]).filter(function(s){return s.status==='ok';}).length;
 document.getElementById('cronStatus').textContent=activeCrons+' Active Crons';

 /* Last activity */
 if(data.lastUpdated){
  try{
   var lu=new Date(data.lastUpdated);
   document.getElementById('lastAct').textContent='Last: '+lu.toLocaleString('en-US',{month:'short',day:'numeric',hour:'numeric',minute:'2-digit'});
  }catch(e){document.getElementById('lastAct').textContent=data.lastUpdated;}
 }else if(act.length>0){
  document.getElementById('lastAct').textContent='Last: '+fmtTime(act[0].time);
 }
}

function escHtml(s){
 var d=document.createElement('div');d.appendChild(document.createTextNode(s));return d.innerHTML;
}

/* ===== INIT ===== */
updateKnob();
setGreeting();
loadData();
setInterval(loadData,60000);
</script>
</body>
</html>