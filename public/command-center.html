<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Aviel's Command Center</title>
    <style>
        /* ================================================
           AVIEL'S COMMAND CENTER
           Origin Design System ‚Äî Single unified page
           Mobile-first for Samsung Galaxy Z Fold 7
           ================================================ */
        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg: #F7F8FA;
            --text: #1A1D23;
            --text-secondary: rgba(26, 29, 35, 0.65);
            --text-muted: rgba(26, 29, 35, 0.42);

            --accent-teal: #0097B2;
            --accent-purple: #6C63FF;
            --accent-green: #10b981;
            --accent-amber: #f59e0b;
            --accent-red: #ef4444;
            --accent-blue: #3b82f6;

            --glass-bg: rgba(255, 255, 255, 0.72);
            --glass-border: rgba(0, 0, 0, 0.06);
            --glass-shadow: 0 4px 12px rgba(0, 0, 0, 0.06), 0 12px 32px rgba(0, 0, 0, 0.08);

            --card-bg: rgba(255, 255, 255, 0.85);
            --card-border: rgba(0, 0, 0, 0.06);
            --card-hover-border: rgba(0, 151, 178, 0.25);

            --font-display: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            --font-body: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;

            --radius-card: 20px;
            --radius-sm: 10px;
            --radius-full: 9999px;
        }

        html[data-theme="dark"] {
            --bg: #0a0a0f;
            --text: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.60);
            --text-muted: rgba(255, 255, 255, 0.38);

            --accent-teal: #13B0C9;
            --accent-purple: #8E87FF;

            --glass-bg: rgba(255, 255, 255, 0.04);
            --glass-border: rgba(255, 255, 255, 0.06);
            --glass-shadow: 0 4px 12px rgba(0, 0, 0, 0.25), 0 12px 32px rgba(0, 0, 0, 0.35);

            --card-bg: rgba(255, 255, 255, 0.05);
            --card-border: rgba(255, 255, 255, 0.08);
            --card-hover-border: rgba(19, 176, 201, 0.30);
        }

        html, body {
            height: 100%;
            font-family: var(--font-body);
            font-size: 16px;
            line-height: 1.6;
            background: var(--bg);
            color: var(--text);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            min-height: 100vh;
            min-height: 100dvh;
        }

        /* Mesh gradient background */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none;
        }
        html[data-theme="dark"] body::before {
            background:
                radial-gradient(ellipse 60% 50% at 20% 10%, rgba(19, 176, 201, 0.08) 0%, transparent 70%),
                radial-gradient(ellipse 50% 60% at 80% 80%, rgba(142, 135, 255, 0.07) 0%, transparent 70%),
                radial-gradient(ellipse 40% 40% at 60% 30%, rgba(16, 185, 129, 0.05) 0%, transparent 70%);
        }
        html:not([data-theme="dark"]) body::before {
            background:
                radial-gradient(ellipse 60% 50% at 20% 10%, rgba(0, 151, 178, 0.07) 0%, transparent 70%),
                radial-gradient(ellipse 50% 60% at 80% 80%, rgba(108, 99, 255, 0.06) 0%, transparent 70%),
                radial-gradient(ellipse 40% 40% at 60% 30%, rgba(16, 185, 129, 0.04) 0%, transparent 70%);
        }

        /* ---- LAYOUT ---- */
        .page {
            position: relative;
            z-index: 1;
            max-width: 640px;
            margin: 0 auto;
            padding: 16px 16px 100px;
        }
        @media (min-width: 768px) {
            .page { padding: 24px 24px 80px; max-width: 720px; }
        }

        /* ---- HEADER ---- */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
            padding-top: 8px;
        }
        .header h1 {
            font-size: 22px;
            font-weight: 700;
            letter-spacing: -0.02em;
        }
        .header .sync-time {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        /* Theme Toggle */
        .theme-toggle {
            width: 44px;
            height: 28px;
            border-radius: 14px;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            cursor: pointer;
            position: relative;
            flex-shrink: 0;
            -webkit-tap-highlight-color: transparent;
        }
        .theme-toggle-knob {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: transform 0.3s ease;
        }
        html[data-theme="dark"] .theme-toggle-knob {
            transform: translateX(16px);
        }

        /* ---- SECTION STYLES ---- */
        .section {
            margin-bottom: 28px;
        }
        .section-label {
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            color: var(--text-muted);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* ---- GLASSMORPHIC PANEL ---- */
        .panel {
            background: var(--card-bg);
            backdrop-filter: blur(20px) saturate(1.4);
            -webkit-backdrop-filter: blur(20px) saturate(1.4);
            border: 1px solid var(--card-border);
            border-radius: var(--radius-card);
            box-shadow: var(--glass-shadow);
            padding: 20px;
            transition: border-color 0.3s ease;
        }
        .panel:active {
            border-color: var(--card-hover-border);
        }

        /* ================================================
           SECTION 1 ‚Äî FOCUS NOW (hero card)
           ================================================ */
        .focus-card {
            background: linear-gradient(135deg, rgba(19, 176, 201, 0.12), rgba(142, 135, 255, 0.10));
            border-color: rgba(19, 176, 201, 0.25);
            padding: 28px 24px;
            position: relative;
            overflow: hidden;
        }
        html:not([data-theme="dark"]) .focus-card {
            background: linear-gradient(135deg, rgba(0, 151, 178, 0.08), rgba(108, 99, 255, 0.07));
            border-color: rgba(0, 151, 178, 0.18);
        }
        .focus-card::after {
            content: '';
            position: absolute;
            top: -40%;
            right: -20%;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(19, 176, 201, 0.08) 0%, transparent 70%);
            pointer-events: none;
        }
        .focus-card .focus-emoji {
            font-size: 36px;
            margin-bottom: 12px;
            display: block;
        }
        .focus-card .focus-title {
            font-size: 22px;
            font-weight: 700;
            letter-spacing: -0.01em;
            line-height: 1.3;
            margin-bottom: 8px;
        }
        .focus-card .focus-why {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.5;
        }
        .focus-card .focus-updated {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 12px;
        }

        /* Primary button */
        .btn-primary {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 14px 28px;
            background: var(--accent-teal);
            color: #fff;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            -webkit-tap-highlight-color: transparent;
            min-height: 48px;
            transition: opacity 0.2s, transform 0.15s;
        }
        .btn-primary:active {
            transform: scale(0.97);
            opacity: 0.9;
        }

        /* ================================================
           SECTION 2 ‚Äî READY FOR YOU
           ================================================ */
        .ready-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .ready-card {
            display: flex;
            align-items: flex-start;
            gap: 14px;
            padding: 16px;
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--card-border);
            border-radius: 14px;
            box-shadow: var(--glass-shadow);
            transition: border-color 0.2s;
        }
        .ready-card.actioned {
            opacity: 0.45;
            transform: scale(0.98);
        }
        .ready-card-body {
            flex: 1;
            min-width: 0;
        }
        .ready-card-title {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 4px;
            line-height: 1.35;
        }
        .ready-card-desc {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.4;
            margin-bottom: 10px;
        }

        /* Category badge */
        .badge {
            display: inline-flex;
            align-items: center;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            padding: 3px 8px;
            border-radius: 6px;
            margin-bottom: 8px;
        }
        .badge-review { background: rgba(239, 68, 68, 0.12); color: var(--accent-red); }
        .badge-input { background: rgba(59, 130, 246, 0.12); color: var(--accent-blue); }
        .badge-decision { background: rgba(245, 158, 11, 0.12); color: var(--accent-amber); }

        /* Action row */
        .action-row {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            align-items: center;
        }
        .action-btn {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 8px 12px;
            border: 1px solid var(--card-border);
            border-radius: 8px;
            background: transparent;
            color: var(--text-secondary);
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            min-height: 36px;
            transition: all 0.2s;
        }
        .action-btn:active {
            background: var(--card-bg);
            border-color: var(--accent-teal);
        }
        .action-btn.selected {
            background: rgba(19, 176, 201, 0.12);
            border-color: var(--accent-teal);
            color: var(--accent-teal);
        }

        .ready-card .open-link {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 8px 14px;
            background: var(--accent-teal);
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            min-height: 36px;
            -webkit-tap-highlight-color: transparent;
            transition: opacity 0.2s;
        }
        .ready-card .open-link:active { opacity: 0.85; }

        .show-more-btn {
            display: block;
            width: 100%;
            padding: 14px;
            border: 1px dashed var(--card-border);
            border-radius: 12px;
            background: transparent;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            text-align: center;
            min-height: 48px;
            -webkit-tap-highlight-color: transparent;
        }
        .show-more-btn:active { background: var(--card-bg); }
        .hidden { display: none !important; }

        /* ================================================
           SECTION 3 ‚Äî QUICK CAPTURE
           ================================================ */
        .capture-panel {
            padding: 20px;
        }
        .capture-form {
            display: flex;
            gap: 8px;
        }
        .capture-input {
            flex: 1;
            padding: 14px 16px;
            border: 1px solid var(--card-border);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.03);
            color: var(--text);
            font-size: 15px;
            font-family: inherit;
            min-height: 48px;
            outline: none;
            transition: border-color 0.2s;
        }
        html:not([data-theme="dark"]) .capture-input {
            background: rgba(0, 0, 0, 0.03);
        }
        .capture-input:focus {
            border-color: var(--accent-teal);
        }
        .capture-input::placeholder {
            color: var(--text-muted);
        }
        .capture-btn {
            padding: 14px 20px;
            background: var(--accent-purple);
            color: #fff;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            min-height: 48px;
            min-width: 48px;
            -webkit-tap-highlight-color: transparent;
            transition: opacity 0.2s;
        }
        .capture-btn:active { opacity: 0.85; }
        .capture-count {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 10px;
            text-align: center;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%) translateY(80px);
            background: var(--accent-green);
            color: #fff;
            padding: 12px 24px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            pointer-events: none;
        }
        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* ================================================
           SECTION 4 ‚Äî RECENT WINS
           ================================================ */
        .wins-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 16px 20px;
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--card-border);
            border-radius: var(--radius-card);
            box-shadow: var(--glass-shadow);
            cursor: pointer;
            color: var(--text);
            font-size: 15px;
            font-weight: 600;
            min-height: 56px;
            -webkit-tap-highlight-color: transparent;
            transition: border-color 0.2s;
        }
        .wins-toggle:active { border-color: var(--card-hover-border); }
        .wins-toggle .arrow {
            transition: transform 0.3s ease;
            font-size: 18px;
        }
        .wins-toggle.open .arrow {
            transform: rotate(180deg);
        }
        .wins-list {
            margin-top: 8px;
            overflow: hidden;
            max-height: 0;
            transition: max-height 0.4s ease;
        }
        .wins-list.open {
            max-height: 600px;
        }
        .win-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 12px 16px;
            border-bottom: 1px solid var(--card-border);
        }
        .win-item:last-child { border-bottom: none; }
        .win-check {
            color: var(--accent-green);
            font-size: 16px;
            flex-shrink: 0;
            margin-top: 1px;
        }
        .win-text {
            font-size: 14px;
            flex: 1;
        }
        .win-date {
            font-size: 11px;
            color: var(--text-muted);
            flex-shrink: 0;
            margin-top: 2px;
        }
        .wins-panel {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--card-border);
            border-radius: 14px;
            overflow: hidden;
        }

        /* ================================================
           SECTION 5 ‚Äî PARKED IDEAS
           ================================================ */
        .parked-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .parked-item {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--card-border);
            border-radius: 14px;
            overflow: hidden;
            box-shadow: var(--glass-shadow);
        }
        .parked-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 16px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            min-height: 48px;
            -webkit-tap-highlight-color: transparent;
        }
        .parked-header .arrow {
            font-size: 14px;
            transition: transform 0.3s;
            color: var(--text-muted);
        }
        .parked-item.open .parked-header .arrow {
            transform: rotate(180deg);
        }
        .parked-detail {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        .parked-item.open .parked-detail {
            max-height: 200px;
        }
        .parked-detail-inner {
            padding: 0 16px 16px;
        }
        .parked-detail-inner p {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            line-height: 1.5;
        }
        .send-to-chet {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 8px 14px;
            border: 1px solid var(--accent-purple);
            border-radius: 8px;
            background: rgba(142, 135, 255, 0.08);
            color: var(--accent-purple);
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            min-height: 36px;
            -webkit-tap-highlight-color: transparent;
        }
        .send-to-chet:active { opacity: 0.7; }

        /* ---- FOOTER ---- */
        .footer {
            text-align: center;
            padding: 20px;
            font-size: 11px;
            color: var(--text-muted);
        }

        /* ---- ANIMATIONS ---- */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(12px); }
            to   { opacity: 1; transform: translateY(0); }
        }
        .section {
            animation: fadeInUp 0.4s ease both;
        }
        .section:nth-child(1) { animation-delay: 0s; }
        .section:nth-child(2) { animation-delay: 0.08s; }
        .section:nth-child(3) { animation-delay: 0.16s; }
        .section:nth-child(4) { animation-delay: 0.24s; }
        .section:nth-child(5) { animation-delay: 0.32s; }

        /* ---- Z-FOLD UNFOLDED ---- */
        @media (min-width: 600px) {
            .focus-card .focus-title { font-size: 26px; }
            .ready-card { padding: 18px 20px; }
        }

        /* ---- DESKTOP ---- */
        @media (min-width: 1024px) {
            .page { max-width: 800px; padding: 32px; }
        }
    </style>
</head>
<body>

<div class="page">

    <!-- HEADER -->
    <div class="header">
        <div>
            <h1>üéØ Command Center</h1>
            <div class="sync-time" id="syncTime"></div>
        </div>
        <div class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
            <div class="theme-toggle-knob" id="themeKnob">üåô</div>
        </div>
    </div>

    <!-- SECTION 1: FOCUS NOW -->
    <div class="section" id="focusSection">
        <div class="section-label">üéØ Focus Now</div>
        <div class="panel focus-card" id="focusCard">
            <!-- Populated by JS -->
        </div>
    </div>

    <!-- SECTION 2: READY FOR YOU -->
    <div class="section" id="readySection">
        <div class="section-label">üì¨ Ready for You</div>
        <div class="ready-list" id="readyList">
            <!-- Populated by JS -->
        </div>
        <button class="show-more-btn hidden" id="showMoreBtn" onclick="showAllReady()">Show more ‚Üì</button>
    </div>

    <!-- SECTION 3: QUICK CAPTURE -->
    <div class="section">
        <div class="section-label">üí° Quick Capture</div>
        <div class="panel capture-panel">
            <form class="capture-form" onsubmit="captureIdea(event)">
                <input type="text" class="capture-input" id="captureInput" placeholder="Drop an idea here‚Ä¶" autocomplete="off">
                <button type="submit" class="capture-btn">üí°</button>
            </form>
            <div class="capture-count" id="captureCount"></div>
        </div>
    </div>

    <!-- SECTION 4: RECENT WINS -->
    <div class="section">
        <div class="section-label">‚úÖ Recent Wins</div>
        <button class="wins-toggle" id="winsToggle" onclick="toggleWins()">
            <span>üèÜ <span id="winsCount">10</span> wins this week</span>
            <span class="arrow">‚ñæ</span>
        </button>
        <div class="wins-list" id="winsList">
            <div class="wins-panel" id="winsPanel">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>

    <!-- SECTION 5: PARKED IDEAS -->
    <div class="section">
        <div class="section-label">üÖøÔ∏è Parked Ideas</div>
        <div class="parked-list" id="parkedList">
            <!-- Populated by JS -->
        </div>
    </div>

    <div class="footer">
        Built by ChetGPT ‚ö° for Aviel &nbsp;|&nbsp; <a href="index.html" style="color:var(--text-muted)">All Tools</a>
    </div>

</div>

<!-- Toast -->
<div class="toast" id="toast">‚úÖ Captured!</div>

<script>
/* ============================
   DATA ‚Äî ChetGPT updates this
   ============================ */
const COMMAND_CENTER_DATA = {
  focusNow: {
    title: "Review the Aviel Dashboard",
    why: "Personal progress tracking ‚Äî wins, confidence, daily push planner",
    link: "https://shadowwall44.github.io/inkredible-tools/aviel-dashboard.html",
    updatedAt: "2026-02-14T22:40:00.000Z"
  },
  readyForYou: [
    { id: "r1", title: "üî¥ Emergency Stop Protocol", desc: "Kill switch + safety rules in AGENTS.md", link: "#", category: "review" },
    { id: "r2", title: "üìä NDF Pricing Database", desc: "4,086 price points, 10 products ‚Äî verify accuracy", link: "https://shadowwall44.github.io/inkredible-tools/quote-tool.html", category: "review" },
    { id: "r3", title: "üí∞ Quote Conversion System", desc: "Close rate tracker + concession scripts", link: "#", category: "review" },
    { id: "r4", title: "üìä Financial Dashboard", desc: "P&L, balance sheet, expense trends", link: "https://shadowwall44.github.io/inkredible-tools/dashboard.html", category: "review" },
    { id: "r5", title: "üé§ INKredible Voice v2", desc: "15 new features ‚Äî needs your testing", link: "#", category: "input" }
  ],
  recentWins: [
    { text: "Memory System Overhaul ‚Äî 49 entries distilled", date: "Feb 14" },
    { text: "Coaching Skills Updated ‚Äî real-world 2026 research", date: "Feb 14" },
    { text: "Kanban Board ‚Äî 111 tasks, fully synced", date: "Feb 14" },
    { text: "NDF Pricing ‚Äî 4,086 price points scraped", date: "Feb 14" },
    { text: "MIS Phase 1 deployed", date: "Feb 14" },
    { text: "14 OpenClaw Skills built", date: "Feb 14" },
    { text: "Safety Framework ‚Äî kill switch active", date: "Feb 14" },
    { text: "QuickBooks Sandbox connected", date: "Feb 13" },
    { text: "Financial Dashboard live", date: "Feb 13" },
    { text: "5 custom skills built", date: "Feb 13" }
  ],
  parkedIdeas: [
    { title: "Pattern Match & Color Swap module for MIS", detail: "AI analyzes carpet pattern ‚Üí finds high-res match ‚Üí color remap" },
    { title: "ChetGPT email setup", detail: "Dedicated email for API signups and automated comms" },
    { title: "Tavily Search API", detail: "Free backup search ‚Äî 1,000/month" },
    { title: "Adobe Illustrator vectorizing workflow", detail: "Scan/vectorize low-res images using AI" },
    { title: "AGENTS.md formal review", detail: "Walk through all rules with Aviel" },
    { title: "OpenClaw organization best practices research", detail: "Last-30-days on how other users organize" }
  ],
  syncTimestamp: "2026-02-14T22:40:00.000Z"
};

/* ============================
   LOCAL STORAGE
   ============================ */
const LS_KEY = 'command_center_v1';
function loadState() {
  try { return JSON.parse(localStorage.getItem(LS_KEY)) || {}; } catch(e) { return {}; }
}
function saveState(s) {
  localStorage.setItem(LS_KEY, JSON.stringify(s));
}
let state = loadState();
if (!state.actions) state.actions = {};
if (!state.captures) state.captures = [];

/* ============================
   RENDER: FOCUS NOW
   ============================ */
function renderFocus() {
  const d = COMMAND_CENTER_DATA.focusNow;
  document.getElementById('focusCard').innerHTML = `
    <span class="focus-emoji">üéØ</span>
    <div class="focus-title">${d.title}</div>
    <div class="focus-why">${d.why}</div>
    <a href="${d.link}" class="btn-primary" target="_blank" rel="noopener">Open ‚Üí</a>
    <div class="focus-updated">Updated: ${new Date(d.updatedAt).toLocaleString()}</div>
  `;
}

/* ============================
   RENDER: READY FOR YOU
   ============================ */
const MAX_VISIBLE = 5;
let showingAll = false;

function renderReady() {
  const list = document.getElementById('readyList');
  const items = COMMAND_CENTER_DATA.readyForYou;
  const btn = document.getElementById('showMoreBtn');
  list.innerHTML = '';

  items.forEach(function(item, i) {
    var action = state.actions[item.id] || null;
    var hidden = (!showingAll && i >= MAX_VISIBLE) ? ' hidden' : '';
    var actioned = action ? ' actioned' : '';

    var badgeClass = 'badge-' + item.category;
    var card = document.createElement('div');
    card.className = 'ready-card' + hidden + actioned;
    card.id = 'ready-' + item.id;

    card.innerHTML = `
      <div class="ready-card-body">
        <span class="badge ${badgeClass}">${item.category}</span>
        <div class="ready-card-title">${item.title}</div>
        <div class="ready-card-desc">${item.desc}</div>
        <div class="action-row">
          <button class="action-btn ${action==='done'?'selected':''}" onclick="setAction('${item.id}','done')">‚úÖ Done</button>
          <button class="action-btn ${action==='fix'?'selected':''}" onclick="setAction('${item.id}','fix')">üîß Fix</button>
          <button class="action-btn ${action==='idea'?'selected':''}" onclick="setAction('${item.id}','idea')">üí° Idea</button>
          ${item.link !== '#' ? `<a href="${item.link}" class="open-link" target="_blank" rel="noopener">Open ‚Üí</a>` : ''}
        </div>
      </div>
    `;
    list.appendChild(card);
  });

  if (items.length > MAX_VISIBLE && !showingAll) {
    btn.classList.remove('hidden');
    btn.textContent = 'Show ' + (items.length - MAX_VISIBLE) + ' more ‚Üì';
  } else {
    btn.classList.add('hidden');
  }
}

function setAction(id, action) {
  if (state.actions[id] === action) {
    delete state.actions[id];
  } else {
    state.actions[id] = action;
  }
  saveState(state);
  renderReady();
}

function showAllReady() {
  showingAll = true;
  renderReady();
}

/* ============================
   RENDER: QUICK CAPTURE
   ============================ */
function captureIdea(e) {
  e.preventDefault();
  var input = document.getElementById('captureInput');
  var text = input.value.trim();
  if (!text) return;

  state.captures.push({ text: text, time: new Date().toISOString() });
  saveState(state);
  input.value = '';
  updateCaptureCount();
  showToast();
}

function updateCaptureCount() {
  var n = state.captures.length;
  document.getElementById('captureCount').textContent = n > 0 ? n + ' idea' + (n > 1 ? 's' : '') + ' captured' : '';
}

function showToast() {
  var t = document.getElementById('toast');
  t.classList.add('show');
  setTimeout(function() { t.classList.remove('show'); }, 1800);
}

/* ============================
   RENDER: RECENT WINS
   ============================ */
function renderWins() {
  var wins = COMMAND_CENTER_DATA.recentWins;
  document.getElementById('winsCount').textContent = wins.length;
  var html = '';
  wins.forEach(function(w) {
    html += '<div class="win-item"><span class="win-check">‚úÖ</span><span class="win-text">' + w.text + '</span><span class="win-date">' + w.date + '</span></div>';
  });
  document.getElementById('winsPanel').innerHTML = html;
}

function toggleWins() {
  var btn = document.getElementById('winsToggle');
  var list = document.getElementById('winsList');
  btn.classList.toggle('open');
  list.classList.toggle('open');
}

/* ============================
   RENDER: PARKED IDEAS
   ============================ */
function renderParked() {
  var ideas = COMMAND_CENTER_DATA.parkedIdeas;
  var html = '';
  ideas.forEach(function(idea, i) {
    html += '<div class="parked-item" id="parked-' + i + '">' +
      '<div class="parked-header" onclick="toggleParked(' + i + ')">' +
        '<span>üÖøÔ∏è ' + idea.title + '</span>' +
        '<span class="arrow">‚ñæ</span>' +
      '</div>' +
      '<div class="parked-detail">' +
        '<div class="parked-detail-inner">' +
          '<p>' + idea.detail + '</p>' +
          '<button class="send-to-chet" onclick="sendToChet(\'' + idea.title.replace(/'/g, "\\'") + '\')">üì® Send to Chet</button>' +
        '</div>' +
      '</div>' +
    '</div>';
  });
  document.getElementById('parkedList').innerHTML = html;
}

function toggleParked(i) {
  document.getElementById('parked-' + i).classList.toggle('open');
}

function sendToChet(title) {
  // Future: sends to Telegram via API
  state.captures.push({ text: '[From Parked] ' + title, time: new Date().toISOString() });
  saveState(state);
  updateCaptureCount();
  var t = document.getElementById('toast');
  t.textContent = 'üì® Sent to Chet!';
  t.classList.add('show');
  setTimeout(function() {
    t.classList.remove('show');
    t.textContent = '‚úÖ Captured!';
  }, 1800);
}

/* ============================
   SYNC TIMESTAMP
   ============================ */
function renderSyncTime() {
  var ts = COMMAND_CENTER_DATA.syncTimestamp;
  document.getElementById('syncTime').textContent = 'Last sync: ' + new Date(ts).toLocaleString();
}

/* ============================
   THEME TOGGLE
   ============================ */
function toggleTheme() {
  var html = document.documentElement;
  var knob = document.getElementById('themeKnob');
  if (html.getAttribute('data-theme') === 'dark') {
    html.setAttribute('data-theme', 'light');
    knob.textContent = '‚òÄÔ∏è';
  } else {
    html.setAttribute('data-theme', 'dark');
    knob.textContent = 'üåô';
  }
  localStorage.setItem('cc-theme', html.getAttribute('data-theme'));
}

(function() {
  var saved = localStorage.getItem('cc-theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
    document.getElementById('themeKnob').textContent = saved === 'dark' ? 'üåô' : '‚òÄÔ∏è';
  }
})();

/* ============================
   INIT
   ============================ */
renderFocus();
renderReady();
renderWins();
renderParked();
renderSyncTime();
updateCaptureCount();
</script>
</body>
</html>
